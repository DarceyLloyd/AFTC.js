<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>darcey@aftc.io</title>
    <link rel="stylesheet" type="text/css" href="https://rawgit.com/DarceyLloyd/AFTC.js/master/link_files/codepen.css">
    <style>
        .box {
            border: 1px solid #464646;
        }
    </style>
    <!-- <script src="../../dist/aftc.new.js"></script> -->
    <script src="../aftc.js"></script>
    <script src="../core/events.js"></script>
    <script src="../core/debug.js"></script>
    <script src="../core/dom.js"></script>
    <script src="../core/is.js"></script>
    <script src="../core/get.js"></script>
    <script src="../core/random.js"></script>
    <script src="../core/string.js"></script>
    <script src="../core/detection.js"></script>
    <script src="../core/array.js"></script>
    <script src="../AFTC/AFTC.Audio.js"></script>
    <script>
        // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
        // Cross Domain Sound File Playback via base64 string
        var file = "http://dev.aftc.io/utils/GetBase64StringFrom.php?src=http://dev.aftc.io/assets/sounds/beats/beat_01.wav";
        var file = "../beats/beat_01.mp3";

        // Maximum compatibility option (recommended)
        // Selection priority is typically first come first served that is compatible by the browser
        // however chrome for example will select flac only if nothing else is compatible
        var files = [
            "../beats/beat_01.flac", // Chrome, Firefox, Opera, Edge (recent), Safari (recent)
            "../beats/beat_01.wav", // Chrome, Firefox, Opera, Edge, Safari
            "../beats/beat_01.ogg", // Chrome, Firefox, Opera, Edge (recent)
            "../beats/beat_01.mp3", // Chrome, Firefox, Opera, Edge, IE, Safari
        ];
        var sound1;

        function setupAudioPlayer() {
            log("setupAudioPlayer()");

            sound1 = new AFTC.Audio({
                hideWarnings: false,
                src: file,
                cache: true,
                volume: 0.4,
                repeat: 1, // Total 2 plays
                preload: true,
                offsetLoopBy: 0.1,
                loopByOffset: false,
                onUpdate: onPlayUpdate,
                onReady: sound1OnReady,
                onComplete: sound1OnComplete
            });

            var btn1 = getElementById("btn1");
            var btn2 = getElementById("btn2");
            var btn3 = getElementById("btn3");
            var btn4 = getElementById("btn4");

            btn1.addEventListener("click", function () {
                sound1.play();
            });

            btn2.addEventListener("click", function () {
                sound1.pause();
            });

            btn3.addEventListener("click", function () {
                sound1.resume();
            });

            btn4.addEventListener("click", function () {
                sound1.stop();
            });
        }

        function sound1OnReady() {
            log("Sound1 is ready!");
        }

        function onPlayUpdate(info) {
            var msg = "";
            msg += info.playCount + "/" + info.totalPlayCount + " - ";
            msg += info.playCount + "/" + info.totalPlayCount + " - ";
            msg += info.currentTime.toFixed(3) + "/" + info.duration.toFixed(3) + " - ";
            msg += info.offsetLoopDuration.toFixed(3);
            setHTML("info", msg);
        }

        function sound1OnComplete(info) {
            log("Sound1 playback complete!");
            var msg = "";
            msg += info.playCount + "/" + info.totalPlayCount + " - ";
            msg += info.playCount + "/" + info.totalPlayCount + " - ";
            msg += info.currentTime.toFixed(3) + "/" + info.duration.toFixed(3) + " - ";
            msg += info.offsetLoopDuration.toFixed(3);
            setHTML("info", msg);
        }
        // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -


        // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
        onReady(function () {
            cls();
            logTo("debug");
            log("darcey@aftc.io");
            setupAudioPlayer();
        });
        // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    </script>
</head>

<body>
    <h2>Sound Player</h2>
    <div id="sound-player">
        <button id="btn1">PLAY</button>
        <button id="btn2">PAUSE</button>
        <button id="btn3">RESUME</button>
        <button id="btn4">STOP</button>
        <br>
        <div id="info" class="box"></div>
    </div>
    <hr>
    <div id="out1" class="box"></div>
    <div id="out2" class="box"></div>
    <div id="out3" class="box"></div>
    <div id="out4" class="box"></div>
    <hr>
    <h3>Please open console...</h3>
    <div id="debug" class="box"></div>

</body>

</html>